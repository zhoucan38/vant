var oe=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var G=(e,n,a)=>n in e?oe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,B=(e,n)=>{for(var a in n||(n={}))se.call(n,a)&&G(e,a,n[a]);if(z)for(var a of z(n))ce.call(n,a)&&G(e,a,n[a]);return e},D=(e,n)=>te(e,ae(n));import{c as M,i as q,V as Y,P as O,G as Z,a as ue}from"./use-translate.55dc92d8.js";import{t as T,b as H,m as k,c as ie,w as R,d as le,a as V}from"./with-install.c8955fea.js";import{C as de}from"./index.e44b8753.js";import{z as S,e as o,C as d,D as g,x as _,N as re,j as pe,v as he,q as me,r as ge,o as ve,c as be,w as J,B as b}from"./vue-libs.b1f02cae.js";import{P as fe}from"./index.6ac6c56d.js";import{u as Ce}from"./use-refs.193a18d1.js";import{T as xe,a as K}from"./index.4925f8d4.js";import{F as je}from"./index.f3698394.js";import{B as Q}from"./index.7415a29e.js";import{C as we}from"./index.9ae4817a.js";import{T as ye}from"./function-call.a491c68d.js";import"./use-route.2e5a4a96.js";import"./index.f787d2de.js";import"./constant.80c6de18.js";import"./interceptor.58bac5b6.js";import"./use-expose.07028ce8.js";import"./use-touch.491278bc.js";import"./use-lazy-render.15986b8e.js";import"./on-popup-reopen.a7f9dc8b.js";import"./index.eccc6437.js";import"./use-id.94af3717.js";import"./index.72c42701.js";import"./index.484db6d1.js";import"./index.64be35d3.js";import"./Checker.54945462.js";import"./mount-component.bb4140aa.js";const[Be,W,N]=M("coupon-cell"),De={title:String,border:T,editable:T,coupons:H(),currency:k("\xA5"),chosenCoupon:ie(-1)};function Te({coupons:e,chosenCoupon:n,currency:a}){const c=e[+n];if(c){let t=0;return q(c.value)?{value:t}=c:q(c.denominations)&&(t=c.denominations),`-${a} ${(t/100).toFixed(2)}`}return e.length===0?N("noCoupon"):N("count",e.length)}var ke=S({name:Be,props:De,setup(e){return()=>{const n=e.coupons[+e.chosenCoupon];return o(de,{class:W(),value:Te(e),title:e.title||N("title"),border:e.border,isLink:e.editable,valueClass:W("value",{selected:n})},null)}}});const Fe=R(ke);function X(e){const n=new Date(e*1e3);return`${n.getFullYear()}.${Y(n.getMonth()+1)}.${Y(n.getDate())}`}const $e=e=>(e/10).toFixed(e%10==0?0:1),ee=e=>(e/100).toFixed(e%100==0?0:e%10==0?1:2),[Ee,r,U]=M("coupon");var Pe=S({name:Ee,props:{chosen:Boolean,coupon:le(Object),disabled:Boolean,currency:k("\xA5")},setup(e){const n=d(()=>{const{startAt:t,endAt:u}=e.coupon;return`${X(t)} - ${X(u)}`}),a=d(()=>{const{coupon:t,currency:u}=e;if(t.valueDesc)return[t.valueDesc,o("span",null,[t.unitDesc||""])];if(t.denominations){const i=ee(t.denominations);return[o("span",null,[u]),` ${i}`]}return t.discount?U("discount",$e(t.discount)):""}),c=d(()=>{const t=ee(e.coupon.originCondition||0);return t==="0"?U("unlimited"):U("condition",t)});return()=>{const{chosen:t,coupon:u,disabled:i}=e,m=i&&u.reason||u.description;return o("div",{class:r({disabled:i})},[o("div",{class:r("content")},[o("div",{class:r("head")},[o("h2",{class:r("amount")},[a.value]),o("p",{class:r("condition")},[u.condition||c.value])]),o("div",{class:r("body")},[o("p",{class:r("name")},[u.name]),o("p",{class:r("valid")},[n.value]),!i&&o(we,{class:r("corner"),modelValue:t},null)])]),m&&o("p",{class:r("description")},[m])])}}});const ne=R(Pe),[Se,p,x]=M("coupon-list"),_e="https://img.yzcdn.cn/vant/coupon-empty.png",Le={code:k(""),coupons:H(),currency:k("\xA5"),showCount:T,emptyImage:k(_e),chosenCoupon:V(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:H(),showExchangeBar:T,showCloseButton:T,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:V(1),exchangeButtonText:String,displayedCouponIndex:V(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean};var Ae=S({name:Se,props:Le,emits:["change","exchange","update:code"],setup(e,{emit:n,slots:a}){const[c,t]=Ce(),u=g(),i=g(),m=g(0),j=g(0),l=g(e.code),F=d(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!l.value||l.value.length<e.exchangeMinLength)),$=()=>{const s=44,h=Z(u).height,C=Z(i).height+s;j.value=(h>C?h:O.value)-C},L=()=>{n("exchange",l.value),e.code||(l.value="")},E=s=>{me(()=>{var h;return(h=c.value[s])==null?void 0:h.scrollIntoView()})},v=()=>o("div",{class:p("empty")},[o("img",{src:e.emptyImage},null),o("p",null,[x("noCoupon")])]),f=()=>{if(e.showExchangeBar)return o("div",{ref:i,class:p("exchange-bar")},[o(je,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,clearable:!0,border:!1,class:p("field"),placeholder:e.inputPlaceholder||x("placeholder"),maxlength:"20"},null),o(Q,{plain:!0,type:"danger",class:p("exchange"),text:e.exchangeButtonText||x("exchange"),loading:e.exchangeButtonLoading,disabled:F.value,onClick:L},null)])},A=()=>{const{coupons:s}=e,h=e.showCount?` (${s.length})`:"",C=(e.enabledTitle||x("enable"))+h;return o(K,{title:C},{default:()=>{var w;return[o("div",{class:p("list",{"with-bottom":e.showCloseButton}),style:{height:`${j.value}px`}},[s.map((y,I)=>o(ne,{key:y.id,ref:t(I),coupon:y,chosen:I===e.chosenCoupon,currency:e.currency,onClick:()=>n("change",I)},null)),!s.length&&v(),(w=a["list-footer"])==null?void 0:w.call(a)])]}})},P=()=>{const{disabledCoupons:s}=e,h=e.showCount?` (${s.length})`:"",C=(e.disabledTitle||x("disabled"))+h;return o(K,{title:C},{default:()=>{var w;return[o("div",{class:p("list",{"with-bottom":e.showCloseButton}),style:{height:`${j.value}px`}},[s.map(y=>o(ne,{disabled:!0,key:y.id,coupon:y,currency:e.currency},null)),!s.length&&v(),(w=a["disabled-list-footer"])==null?void 0:w.call(a)])]}})};return _(()=>e.code,s=>{l.value=s}),_(O,$),_(l,s=>n("update:code",s)),_(()=>e.displayedCouponIndex,E),re(()=>{$(),E(e.displayedCouponIndex)}),()=>o("div",{ref:u,class:p()},[f(),o(xe,{active:m.value,"onUpdate:active":s=>m.value=s,class:p("tab")},{default:()=>[A(),P()]}),o("div",{class:p("bottom")},[pe(o(Q,{round:!0,block:!0,type:"danger",class:p("close"),text:e.closeButtonText||x("close"),onClick:()=>n("change",-1)},null),[[he,e.showCloseButton]])])])}});const Ie=R(Ae),rn=S({setup(e){const n=ue({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),a=(v=999999)=>String(Math.floor(Math.random()*v)+1),c=g(!1),t=g(-1),u=g([]),i=d(()=>({id:1,condition:`\u65E0\u4F7F\u7528\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:n("coupon.name"),description:n("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),m=d(()=>D(B({},i.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),j=d(()=>D(B({},i.value),{id:3,reason:n("coupon.reason")})),l=d(()=>D(B({},m.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:n("coupon.reason")})),F=d(()=>[i.value,m.value,...u.value]),$=d(()=>[j.value,l.value]),L=v=>{c.value=!1,t.value=v},E=()=>{ye(n("exchange")),u.value.push(D(B({},i.value),{id:a()}))};return(v,f)=>{const A=ge("demo-block");return ve(),be(A,{title:b(n)("basicUsage")},{default:J(()=>[o(b(Fe),{coupons:b(F),"chosen-coupon":t.value,onClick:f[0]||(f[0]=P=>c.value=!0)},null,8,["coupons","chosen-coupon"]),o(b(fe),{show:c.value,"onUpdate:show":f[1]||(f[1]=P=>c.value=P),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:J(()=>[o(b(Ie),{coupons:b(F),"chosen-coupon":t.value,"disabled-coupons":b($),onChange:L,onExchange:E},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{rn as default};
